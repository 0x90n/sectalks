% A MOTHERFUCKING DOCUMENT FUCK

\documentclass[11pt]{report}
\usepackage{listings}
\usepackage{color}
\usepackage{hyperref}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\usepackage{graphicx}
\lstset{frame=tb,
  language=bash,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true
  tabsize=4
}

\begin{document}

%        RICKROLLING IS FUCKING SHITHOUSE


\title{SECTALKS\\CTF 0x04 Solution}
\author{swarley, kronicd}
\date{\today}
\maketitle
\section{START}

We have a 128 byte file named `key' and a 4 MB file named `mail'.
After messing around thinking the key was the actual AES encryption key kronicd realised it was the password.

From there it was a matter of stripping the mail headers from the mail file, and decrypting it with the keyfile.\\
\begin{lstlisting}
swarley@Pro: openssl enc -d -aes-128-cbc -kfile key -in mail -out decrypt
\end{lstlisting}

Open decrypt in texteditor and strip the header and footer to leave a nice block of base64'd data (which is likely an mp4 given the name of the "attachment")\\
\begin{lstlisting}
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="W1EBFwEcSaQ.mp4"
Content-Transfer-Encoding: base64
\end{lstlisting}

% FUCKING RICK ASTLEY
Then it was a case of decoding the base64'd data into our mp4 file thusly:
\begin{lstlisting}
swarley@Pro: base64 -D -i decrypt2 -o fuckyou.mp4
\end{lstlisting}

\section{FIN}

\begin{lstlisting}
<flag>
flag: the radio is playing some sort of.. rick roll
</flag>
\end{lstlisting}

\begin{figure}[hc]
  \includegraphics[totalheight=15cm]{lol}
  \caption{A mad wicked sick image of the man himself.}
\end{figure}

%    FUCK RICK ASTLEY
%
%                                                ``                                                    
%                                          ,:,..'';;.`  ``                                             
%                                       `.:++'#+'''+'''''+';`                                          
%                                    `,:'+##+++++#++'++'+#++';::.                                      
%                                 `:++++###+++++#+#+###+#+#+++'+.,                                     
%                           `.,:`:#+###+####+++##########+#+##+''.'                                    
%                           .,;'#+#########+##################+++:;:`                                  
%                         .++##+#+##@#########++##+#########+###'',+;                                  
%                        `#############+###########+####+###+####+;'+.                                 
%                        #;+#+##############+#+++##++###+##+####++'++'`                                
%                       :'#+###############++#+++'+'####+#@+#+#+#+++';;``                              
%                      `######################++++++++###+####+##+#++':'..:.                           
%                      +@+#+####+##########+#############+#######'+++'+++';:                           
%                      ###################++++++############@@###'++#'#+++',,                          
%                     :###+#@#####+#+##@##+######@#@@####@#####@##++#+##+##+'.                         
%                     :##++########++#############@#@#@@@@##@######+#+######+:                         
%                     :##+#+#@#+#+##+###+#######@@@@@#@@@@###@###+#+##@####+++:`                       
%                   `.+##+###+##++##+#+++#+########@@@@@@@##@######+##@#######';                       
%                  ``'#+++##++##+++##+########@##@@@@@@@@#@@@########@########++.                      
%                  .:++++++++#++###+#+#+++###@@@@@@@@@@@@@@##@##################+                      
%                  :###+#++++''+###+###@@@#@@@@@@@@@@@@@@@@@#@######@###########+,                     
%                 `+######+#+#++#+#####@@@@@@@@@@@@@@@@##@#@@@@@###@###########++'                     
%                 ;++###+#+##+#+###@@@##@@@@@@@@@@@#@@#@###@##@@#################+                     
%                ,'#++######+#+++####@@@@@@@@@@@@@@#@################@#+#########+'                    
%                '#+#+#########+++#++##@@@@@@@#@@#@#########+###+######@##########'                    
%               .+##+#+########+####@##@@@@@@@@######+###+#++++++++####+####@######.                   
%               ,+#####+###+####@###@####@#######+##+++++'+'''''+'++########@#@@@#+'                   
%               .;##:######+++########@####@####+++'';'';;''''''+'++###+####@####@#+                   
%                '+##+#+#####+##############++++'++;;;;;;;;';'''''''+##############+                   
%                :+####@@####++++##+++'+++++++'+';;::::;;;;;;;''''''+++######@@#@##+'                  
%                 +########+++++''';';;;;'''+''';;:::::;;;;;;;;';''+++#######@@@#@##'`                 
%                  ,'#######++'';;::,:::;;;'';;::::::::;;;;;;''''''''++#######@#@##++                  
%                   '++#+###+;;:,:,,,,,,,:;;::::::,,:::;;;;;;''''''++'++##@@#####@@+'                  
%                  .:++##+#+'::,,,,,,,,,.,,,::::::,,,::;;;;;';'''';'''+##@##@@@#####+.                 
%                  `'++#+++':;:,,,,,,,,,,,,,:::::,,::::;;;;;;';';'''++++##@#@@#@####+,                 
%                   `.;#+++;:::,,,,,,,,.,,,::::::::,,:::;;;;''+'';''+'+###@#@@@#####+;                 
%                    ;,##++:::::,,,,,,,,,,,::::,::,,:::;;;;';''';'''++++#####@#@####+:                 
%                    .,+#++::::,,,,,,,,,,,,:::,:,::,::::;;;;'''';'''++++###########++:                 
%                    :;++++:::::,,,,,,,,,,,,,,,,:::,,:::;;;';;';;'''++'++###@@######+.                 
%                    `+##++:::::,,,,,,,,,,,:::,,,:,:,:::;;''''';';'''+''++#####@###++,                 
%                    ,;+#++::::::,,,,,,,,,,,,,:,,,::,:::;;;'''';''''+++'+'+#########+,                 
%                     .##++,::::::,,,,,,,,,,,,,,,,,:::::;;;';';'''''''+'''+########+':                 
%                     `###+:::::::,,,,,,,,,,,,,,,,,:::::;;;;';;;''''+'''''+##@#####++,                 
%                      ###+;::::::,,,,,,,,,,,:::,,:::::;;;;';;;;'''''''''''+#######+;,                 
%                      +###:::::::,:,,::,,,,::::,::::;:;;;;';'''''''++''+'+'#####+#+;`                 
%                      +##+;::::::,:,,:,:::,:::::::::;;;;'+++++++++++++'+'+'+###@##++;                 
%                      .###;::::,,::,:::::::::::::::;''++++#++'+'++++#++''''####+##+'+;                
%                       ++#':::,::::::::::::::::::;;;'+++++++''''+++++++'+'++######+##+`               
%                       '+++:::::::;;'''';::::::::;'''+++'+';';''''++++#+++'+#####+#+#+'               
%                       `++#:::;''+''++''';;:::::;;'+++'+'###@####+++++'+'+'++###+#++++'               
%                        '++::'''''''''+'+';;::::;;'++''++:+'@##+#++'++'+'''++###++#+++'               
%                        :'#;;';;;;;;;;'''';;:::::''++';#;::###''+++'''''+''++###+###'#'               
%                        .+++;;:;:::;;'+++;;;::,::''++;+';::;';''''''''''+''''#######+#'               
%                         `'+::::;'+#++@#'+::::,,;'+''':::::::;'';;';;'''++'+'+######++;               
%                          :+,::;'#':####;';:::,,;;'+';:::::::;;;;;;;;;''+'''''++#+##+'                
%                          `+,::'++;,:+':::,:::::;;'''';;,::::::;;;;;;;''+'+''''++###+'                
%                           ',::;;;;;::::;:,:::::;'''';;;;::::::::;;;;'''+'+''''+++##+'                
%                           ;:,:::::::,::::::::::;''''';;;:::::::;;;;;''++++''''+++++';                
%                           `:::::::::,,:::::::::;''''';;;::::::::;;;;''+'+'';''##++++`                
%                            ;:::,:::,,,:,,::::::;'''''';;;:::::::;;''''+'+++'''+#+++'                 
%                            ;,::,::,:::,,,::::::;''''''';:::::::;;;;''+'+'+'''++##''                  
%                            :,:,,:::,,,,,,:::::;;''+'+'';;;:::::;;;''''+'+'+'''##+#;                  
%                   .         ::::::,,,,:,::::::;;'''''+';;::::::;;'''+'+++++''+++++.                  
%                             ,::::::::,,:::::::;;''''''+;;;:;;:;;;''++++'++'''#+++.                   
%                            `,:::::::::::,:::::;;;''''++';;:;;:;;';'+++++++++'+#++                    
%                            ,,:::::::,:::::::,::;'#+++#++';::;;;;'''++++++'++'++'.                    
%                            ,,::::::::,:::::::;;'++##++++';;::;;''''+++++++''''+;                     
%                            ,,,;:::::::::::;';''+#@@#+##+';;:;;;;'''++++++''''++'                     
%                            :,,::::::::::::''';++###+##'';;;;;;;''''''++++'+'''''.                    
%                           `:,,::::::::::::,;;;'++++#'''';;;;;;;''''+++'+'+'''+++;'++':.`          .;'
%                           ,,,:,::::::::::::::::;;'''''';';;;;;;''''+++++++++'+++;;+@#+';;;;.   ;+++++
%                          ,,,,,,::::::::::::::::;;;;;'';;'';;'';''''+++++++++'+'+++'###+'';'';'++#+++#
%                         ,,,,,,,:::::::::::::::;;;;;;''';'''''';';+'++++'++++'++'@+++@#@#+;'++###++++#
%                        .,,,,,:,:;::::::::::::::;;::;;;';';''''';';''++++++++++++@#+##@@#########+++@#
%                      `,::,,::,:::::::::::::::::::::;;;''''+++';';+'++++++++++#++@#++#@@#########++##+
%                     .,::,:::::;;;:::::::;;;:::::::;+++++###+';;'''+'#+++#+++++++@++##@@########++##+'
%                    `,,,,,::::;;;;;:::::;;;;:;;''''++++###++';;;''+'#+#+#+#++++#######@@#######++##+;:
%                    ,,,:,::::;;;;;;:::::;;+''''+++#+++''''+'';;''''++++##++#+++####+##@@###@@##'##+;;;
%                   ,:,::::::;;;';';;;;:;;;;::;;;;;;;;;''+++';;;'''++++#++##+###########@#+#@##+###;;;;
%                  `:,:,:::::;;;;';;';;;;;;::;;:;::;;;''+++'';'''''++#+#################@##@@@++++'';;:
%                 `,:::::::;;';;''''';;;;;:::::;;;;'''++++'';;''''+++#+################@@##@@#++#';:;;;
%                 ::,::::::;;;'''''''';;:;;::::;''+++++''+'';'''''+++#########+###+##@##@##@#++#;';;;;;
%                ::,:::::;;;'''''''''+';;;;:;::;;;';';;;;;;;;;'''++##################@#@+##@+++'';;:'';
%               :::::::::;;'''+''''+'+++;;:::::;;;:;:::;;;;;;''''+++####################+#@@++'';:;;+';
%              ,::::::::;;'''++++'+++++#+;;;:::::::::::::;;;;''''+#####################@+#@#'#'';;';#';
%             ,:::::::;;;'''''+++'+++#####;;;;;:::::::::;;;''''++############@#########@+#@'+'';'';'@+;
%            ,:::::::;;;;''+++++'+++##+:,,::;;;;::::::;:;;''''++############@##########@+@++@+';;;;+@''
%           ::,::::;;;;;'''+++++++###'      `;;:;:;:;;;;;''+++#######################+###++#+''';;;#@+;
%          ::::::::;;;;''''+++++++##`         ;;;;;;;;''''++######@#######@###########++#'#@';':;;;#@';
%         :::::::;;;;;;''++++++++##            `';''''++++############+########++#######''##';':;;;@@':
%        :::::::::;;;;''++++++++++              ;;'++#+##############+####+####+#+##+##+'+@';;;;;''@+:;
%       :::::::::;;;'''''+++++++'              :';;;''''''++++#+#++++++##++###+#+###+##''@#;;;';;;'@';'
%     .:::::::::;;''''''+++#+###.,.           `;';;;'''''+'+'+'++++++++++###++++##@++#+''@';;;;;;;'#;':
%    `::::::::;:;;'''''+++#++##;;;;;.         :'';';';;';'''''+''+++++#'#+#'++####++++''#@';;:';';+';::
%   ,:::::::::;;;';'''++++####:;''';;'.      ,;;++:+;;;;''''''''+''++++++++''+###+'+#';'@;';;;;;;;#';:;
%  ,:::::::::;;;;'''+'++#+###;;;;'+++'';`  `:;;'##;'';;;''''''''+'+++++'+''+++##+''''';+@;';;;;:;:#:;:;
%`:::::::::;;;;;;'+'++++####+';;++#+++;;;;:;:;+++#+':;'';;;;'''''++++'++++'+++#+'';+'''#@;;;;;;;;;+;;:;
%:::::::::;;;;;'''+'++#####+;+''++++####+++'''##++@''';''';''';''++''';';'+++#++'';''''@+:';;;;;;;#;::;
%:::::::::;:;;;;''+++######'''++@+#####@##++#++#+###'';;;'+''''+++'''''';'++##''';#'';#@';';;;;:;;+;::;
%::::::;:;;;;;;''++++####+ ;;+++#######@####+++++##@'';;;;;''+'++;'''';+'+++++'+:;+'';@@;;;;;;:;;;;:;;;
%,:::::::;;;;'''+'++##### `''++++########+#++++'###@+';;;;;;;'#+';;;;'''++++''';''#'''@+;';;:;;;;';;:::
%,::::::;:;;';;''++#####. :;;''+++#####+++++++'+##+##';;;;;;;'@##';;;''+++'';':':@#';#@';';;;';':'::;::
%,::::::;;;;;''+'+#####+;''+++++##@######+#++++#+###@'''';;:;#+##++;;'''''+'';';+@#';#@;;;;;;;;;;;;;:;;
%:,:::::;;;;'''+++##@##'''+#+####@@####+#+++'++++####+;''';:@#@#++#'';''';';:;;;@@#';@#;;';:';;:;;;:;;;
%:,:::::;;;;'''++####@'''++####@#@@@##+++++++++++#++##;;';';##+++@@@#;'++';;;;;:@##''@+:;;:':';';':;;;;
%,::::;;;'''''++####@+++++######@@@####+#++'++++##++#@;;;';;@#+'@#@@@;;:;;;::;;#@@#;#@+'';;;';;;;;;;:;;
%::::::;;;;''+++###@#+++++######@@@###++##++'+''+#++@@;;;;;'@#++@@@@@@;;;';;;:;@@##;#@+;;;;;;';';;;;;;;
%:::::;;;;';''++####+''+++####@@@#####++++++++'+#+#+#@#;';;+@#'#@@@@@@@;;;;;;;'@@@+'@@';;;;';;''';::;;;
%:::::;;;'''+#+##@@#@@#####@@@#@@@######+++++'+'#+++#@@;;;;#@#+#@@@@@#@+,;;;;;@@@@;'@#'';;;;';';;;;:;;;
%::;:;;;;';+++++#@@@@##@@@@#@@@@@@####+'+++++'+'#'#+#@@';';#@@+@@@@@@+@'+:';;;@@@@:+@#'';;;';'';;:;;;;;
%:::;;;;;'''+'++@@@@@@##@@@@#@@#@@####++++#'+''+++++#@#;;::@@@+#@@@@#+@'#':;;;@@@#;#@#';':''';';;:;;';;
%:;;;;;;;''''++#@@##@##@@@@@@@@@#@@###+++++'''+'+++'#@+;;;;@@@+#@@@@#'#;@'#:;+@@##;#@+;;';'';';;;;;;;:;
%::::;;;';:+####@@@@@@@@@@@@@@@##@@@##++#++''''+++++#@'';:#@@###@@@@#+#'''#@++@@#+'##+';';''';';;:;:;;;
%::;;;;'',:#####@@@@@@@@@@@@@@@@##@###+#++++''+'+++'#@''::#@@#'#@@@@#+#;''##'+@@+';##';;;';';+'':;::;;;
%;:;;;;;'#+#+##@@@@@@@@@@@@@@@@@##@###+++++++'+'++++#@';;'######@@@@###;'+##;#@@+;'##':;;'''+'';;:;;;;;
%:;;;;;+#++'#@@@@@@@@@@@@@@#@@@@@@#@##+##+'''+'++++++@':''+##+@+#@@@@#+;'#@+'@@#':+#+;:';;+'''''::::;::
%;;;';''++###+@@@@@@@@@@@@@@@##@@@######++++'+''''++#@''''+##+@#+#@@@@+;;##';@@+''+#+';;;''++'';;:::;:;


% SO SICK OF THIS FUCKING RICK ASTLEY SHIT
\end{document}